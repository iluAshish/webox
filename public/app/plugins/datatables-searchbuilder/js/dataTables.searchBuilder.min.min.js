(function(){"use strict";(function(factory){if(typeof define==="function"&&define.amd){define(["jquery"],function($){return factory($,window,document)})}else if(typeof exports==="object"){module.exports=function(root,$){if(!root){root=window}return factory($,root,root.document)}}else{factory(jQuery,window,document)}})(function($,window,document,undefined$1){var dateLib=window.moment?window.moment:window.dayjs?window.dayjs:null;var DateTime=function(input,opts){this.c=$.extend(true,{},DateTime.defaults,opts);var classPrefix=this.c.classPrefix;var i18n=this.c.i18n;if(!dateLib&&this.c.format!=="YYYY-MM-DD"){throw"DateTime: Without momentjs or dayjs only the format 'YYYY-MM-DD' can be used"}if(typeof this.c.minDate==="string"){this.c.minDate=new Date(this.c.minDate)}if(typeof this.c.maxDate==="string"){this.c.maxDate=new Date(this.c.maxDate)}var structure=$('<div class="'+classPrefix+'">'+'<div class="'+classPrefix+'-date">'+'<div class="'+classPrefix+'-title">'+'<div class="'+classPrefix+'-iconLeft">'+"<button>"+i18n.previous+"</button>"+"</div>"+'<div class="'+classPrefix+'-iconRight">'+"<button>"+i18n.next+"</button>"+"</div>"+'<div class="'+classPrefix+'-label">'+"<span></span>"+'<select class="'+classPrefix+'-month"></select>'+"</div>"+'<div class="'+classPrefix+'-label">'+"<span></span>"+'<select class="'+classPrefix+'-year"></select>'+"</div>"+"</div>"+'<div class="'+classPrefix+'-calendar"></div>'+"</div>"+'<div class="'+classPrefix+'-time">'+'<div class="'+classPrefix+'-hours"></div>'+'<div class="'+classPrefix+'-minutes"></div>'+'<div class="'+classPrefix+'-seconds"></div>'+"</div>"+'<div class="'+classPrefix+'-error"></div>'+"</div>");this.dom={container:structure,date:structure.find("."+classPrefix+"-date"),title:structure.find("."+classPrefix+"-title"),calendar:structure.find("."+classPrefix+"-calendar"),time:structure.find("."+classPrefix+"-time"),error:structure.find("."+classPrefix+"-error"),input:$(input)};this.s={d:null,display:null,minutesRange:null,secondsRange:null,namespace:"dateime-"+DateTime._instance++,parts:{date:this.c.format.match(/[YMD]|L(?!T)|l/)!==null,time:this.c.format.match(/[Hhm]|LT|LTS/)!==null,seconds:this.c.format.indexOf("s")!==-1,hours12:this.c.format.match(/[haA]/)!==null}};this.dom.container.append(this.dom.date).append(this.dom.time).append(this.dom.error);this.dom.date.append(this.dom.title).append(this.dom.calendar);this._constructor()};$.extend(DateTime.prototype,{destroy:function(){this._hide(true);this.dom.container.off().empty();this.dom.input.off(".datetime")},errorMsg:function(msg){var error=this.dom.error;if(msg){error.html(msg)}else{error.empty()}return this},hide:function(){this._hide();return this},max:function(date){this.c.maxDate=typeof date==="string"?new Date(date):date;this._optionsTitle();this._setCalander();return this},min:function(date){this.c.minDate=typeof date==="string"?new Date(date):date;this._optionsTitle();this._setCalander();return this},owns:function(node){return $(node).parents().filter(this.dom.container).length>0},val:function(set,write){if(set===undefined$1){return this.s.d}if(set instanceof Date){this.s.d=this._dateToUtc(set)}else if(set===null||set===""){this.s.d=null}else if(set==="--now"){this.s.d=new Date}else if(typeof set==="string"){if(dateLib){var m=dateLib.utc(set,this.c.format,this.c.locale,this.c.strict);this.s.d=m.isValid()?m.toDate():null}else{var match=set.match(/(\d{4})\-(\d{2})\-(\d{2})/);this.s.d=match?new Date(Date.UTC(match[1],match[2]-1,match[3])):null}}if(write||write===undefined$1){if(this.s.d){this._writeOutput()}else{this.dom.input.val(set)}}if(!this.s.d){this.s.d=this._dateToUtc(new Date)}this.s.display=new Date(this.s.d.toString());this.s.display.setUTCDate(1);this._setTitle();this._setCalander();this._setTime();return this},_constructor:function(){var that=this;var classPrefix=this.c.classPrefix;var onChange=function(){that.c.onChange.call(that,that.dom.input.val(),that.s.d,that.dom.input)};if(!this.s.parts.date){this.dom.date.css("display","none")}if(!this.s.parts.time){this.dom.time.css("display","none")}if(!this.s.parts.seconds){this.dom.time.children("div."+classPrefix+"-seconds").remove();this.dom.time.children("span").eq(1).remove()}this._optionsTitle();window.allan=this;if(this.dom.input.attr("type")==="hidden"){this.dom.container.addClass("inline");this.c.attachTo="input";this.val(this.dom.input.val(),false);this._show()}this.dom.input.attr("autocomplete","off").on("focus.datetime click.datetime",function(){if(that.dom.container.is(":visible")||that.dom.input.is(":disabled")){return}that.val(that.dom.input.val(),false);that._show()}).on("keyup.datetime",function(){if(that.dom.container.is(":visible")){that.val(that.dom.input.val(),false)}});this.dom.container.on("change","select",function(){var select=$(this);var val=select.val();if(select.hasClass(classPrefix+"-month")){that._correctMonth(that.s.display,val);that._setTitle();that._setCalander()}else if(select.hasClass(classPrefix+"-year")){that.s.display.setUTCFullYear(val);that._setTitle();that._setCalander()}else if(select.hasClass(classPrefix+"-hours")||select.hasClass(classPrefix+"-ampm")){if(that.s.parts.hours12){var hours=$(that.dom.container).find("."+classPrefix+"-hours").val()*1;var pm=$(that.dom.container).find("."+classPrefix+"-ampm").val()==="pm";that.s.d.setUTCHours(hours===12&&!pm?0:pm&&hours!==12?hours+12:hours)}else{that.s.d.setUTCHours(val)}that._setTime();that._writeOutput(true);onChange()}else if(select.hasClass(classPrefix+"-minutes")){that.s.d.setUTCMinutes(val);that._setTime();that._writeOutput(true);onChange()}else if(select.hasClass(classPrefix+"-seconds")){that.s.d.setSeconds(val);that._setTime();that._writeOutput(true);onChange()}that.dom.input.focus();that._position()}).on("click",function(e){var d=that.s.d;var nodeName=e.target.nodeName.toLowerCase();var target=nodeName==="span"?e.target.parentNode:e.target;nodeName=target.nodeName.toLowerCase();if(nodeName==="select"){return}e.stopPropagation();if(nodeName==="button"){var button=$(target);var parent=button.parent();if(parent.hasClass("disabled")&&!parent.hasClass("range")){button.blur();return}if(parent.hasClass(classPrefix+"-iconLeft")){that.s.display.setUTCMonth(that.s.display.getUTCMonth()-1);that._setTitle();that._setCalander();that.dom.input.focus()}else if(parent.hasClass(classPrefix+"-iconRight")){that._correctMonth(that.s.display,that.s.display.getUTCMonth()+1);that._setTitle();that._setCalander();that.dom.input.focus()}else if(button.parents("."+classPrefix+"-time").length){var val=button.data("value");var unit=button.data("unit");if(unit==="minutes"){if(parent.hasClass("disabled")&&parent.hasClass("range")){that.s.minutesRange=val;that._setTime();return}else{that.s.minutesRange=null}}if(unit==="seconds"){if(parent.hasClass("disabled")&&parent.hasClass("range")){that.s.secondsRange=val;that._setTime();return}else{that.s.secondsRange=null}}if(val==="am"){if(d.getUTCHours()>=12){val=d.getUTCHours()-12}else{return}}else if(val==="pm"){if(d.getUTCHours()<12){val=d.getUTCHours()+12}else{return}}var set=unit==="hours"?"setUTCHours":unit==="minutes"?"setUTCMinutes":"setSeconds";d[set](val);that._setTime();that._writeOutput(true);onChange()}else{if(!d){d=that._dateToUtc(new Date)}d.setUTCDate(1);d.setUTCFullYear(button.data("year"));d.setUTCMonth(button.data("month"));d.setUTCDate(button.data("day"));that._writeOutput(true);if(!that.s.parts.time){setTimeout(function(){that._hide()},10)}else{that._setCalander()}onChange()}}else{that.dom.input.focus()}})},_compareDates:function(a,b){return this._dateToUtcString(a)===this._dateToUtcString(b)},_correctMonth:function(date,month){var days=this._daysInMonth(date.getUTCFullYear(),month);var correctDays=date.getUTCDate()>days;date.setUTCMonth(month);if(correctDays){date.setUTCDate(days);date.setUTCMonth(month)}},_daysInMonth:function(year,month){var isLeap=year%4===0&&(year%100!==0||year%400===0);var months=[31,isLeap?29:28,31,30,31,30,31,31,30,31,30,31];return months[month]},_dateToUtc:function(s){return new Date(Date.UTC(s.getFullYear(),s.getMonth(),s.getDate(),s.getHours(),s.getMinutes(),s.getSeconds()))},_dateToUtcString:function(d){return d.getUTCFullYear()+"-"+this._pad(d.getUTCMonth()+1)+"-"+this._pad(d.getUTCDate())},_hide:function(destroy){if(!destroy&&this.dom.input.attr("type")==="hidden"){return}var namespace=this.s.namespace;this.dom.container.detach();$(window).off("."+namespace);$(document).off("keydown."+namespace);$("div.dataTables_scrollBody").off("scroll."+namespace);$("div.DTE_Body_Content").off("scroll."+namespace);$("body").off("click."+namespace)},_hours24To12:function(val){return val===0?12:val>12?val-12:val},_htmlDay:function(day){if(day.empty){return'<td class="empty"></td>'}var classes=["selectable"];var classPrefix=this.c.classPrefix;if(day.disabled){classes.push("disabled")}if(day.today){classes.push("now")}if(day.selected){classes.push("selected")}return'<td data-day="'+day.day+'" class="'+classes.join(" ")+'">'+'<button class="'+classPrefix+"-button "+classPrefix+'-day" type="button" '+'data-year="'+day.year+'" data-month="'+day.month+'" data-day="'+day.day+'">'+"<span>"+day.day+"</span>"+"</button>"+"</td>"},_htmlMonth:function(year,month){var now=this._dateToUtc(new Date),days=this._daysInMonth(year,month),before=new Date(Date.UTC(year,month,1)).getUTCDay(),data=[],row=[];if(this.c.firstDay>0){before-=this.c.firstDay;if(before<0){before+=7}}var cells=days+before,after=cells;while(after>7){after-=7}cells+=7-after;var minDate=this.c.minDate;var maxDate=this.c.maxDate;if(minDate){minDate.setUTCHours(0);minDate.setUTCMinutes(0);minDate.setSeconds(0)}if(maxDate){maxDate.setUTCHours(23);maxDate.setUTCMinutes(59);maxDate.setSeconds(59)}for(var i=0,r=0;i<cells;i++){var day=new Date(Date.UTC(year,month,1+(i-before))),selected=this.s.d?this._compareDates(day,this.s.d):false,today=this._compareDates(day,now),empty=i<before||i>=days+before,disabled=minDate&&day<minDate||maxDate&&day>maxDate;var disableDays=this.c.disableDays;if(Array.isArray(disableDays)&&$.inArray(day.getUTCDay(),disableDays)!==-1){disabled=true}else if(typeof disableDays==="function"&&disableDays(day)===true){disabled=true}var dayConfig={day:1+(i-before),month:month,year:year,selected:selected,today:today,disabled:disabled,empty:empty};row.push(this._htmlDay(dayConfig));if(++r===7){if(this.c.showWeekNumber){row.unshift(this._htmlWeekOfYear(i-before,month,year))}data.push("<tr>"+row.join("")+"</tr>");row=[];r=0}}var classPrefix=this.c.classPrefix;var className=classPrefix+"-table";if(this.c.showWeekNumber){className+=" weekNumber"}if(minDate){var underMin=minDate>=new Date(Date.UTC(year,month,1,0,0,0));this.dom.title.find("div."+classPrefix+"-iconLeft").css("display",underMin?"none":"block")}if(maxDate){var overMax=maxDate<new Date(Date.UTC(year,month+1,1,0,0,0));this.dom.title.find("div."+classPrefix+"-iconRight").css("display",overMax?"none":"block")}return'<table class="'+className+'">'+"<thead>"+this._htmlMonthHead()+"</thead>"+"<tbody>"+data.join("")+"</tbody>"+"</table>"},_htmlMonthHead:function(){var a=[];var firstDay=this.c.firstDay;var i18n=this.c.i18n;var dayName=function(day){day+=firstDay;while(day>=7){day-=7}return i18n.weekdays[day]};if(this.c.showWeekNumber){a.push("<th></th>")}for(var i=0;i<7;i++){a.push("<th>"+dayName(i)+"</th>")}return a.join("")},_htmlWeekOfYear:function(d,m,y){var date=new Date(y,m,d,0,0,0,0);date.setDate(date.getDate()+4-(date.getDay()||7));var oneJan=new Date(y,0,1);var weekNum=Math.ceil(((date-oneJan)/864e5+1)/7);return'<td class="'+this.c.classPrefix+'-week">'+weekNum+"</td>"},_options:function(selector,values,labels){if(!labels){labels=values}var select=this.dom.container.find("select."+this.c.classPrefix+"-"+selector);select.empty();for(var i=0,ien=values.length;i<ien;i++){select.append('<option value="'+values[i]+'">'+labels[i]+"</option>")}},_optionSet:function(selector,val){var select=this.dom.container.find("select."+this.c.classPrefix+"-"+selector);var span=select.parent().children("span");select.val(val);var selected=select.find("option:selected");span.html(selected.length!==0?selected.text():this.c.i18n.unknown)},_optionsTime:function(unit,count,val,allowed,range){var classPrefix=this.c.classPrefix;var container=this.dom.container.find("div."+classPrefix+"-"+unit);var i,j;var render=count===12?function(i){return i}:this._pad;var classPrefix=this.c.classPrefix;var className=classPrefix+"-table";var i18n=this.c.i18n;if(!container.length){return}var a="";var span=10;var button=function(value,label,className){if(count===12&&typeof value==="number"){if(val>=12){value+=12}if(value==12){value=0}else if(value==24){value=12}}var selected=val===value||value==="am"&&val<12||value==="pm"&&val>=12?"selected":"";if(allowed&&$.inArray(value,allowed)===-1){selected+=" disabled"}if(className){selected+=" "+className}return'<td class="selectable '+selected+'">'+'<button class="'+classPrefix+"-button "+classPrefix+'-day" type="button" data-unit="'+unit+'" data-value="'+value+'">'+"<span>"+label+"</span>"+"</button>"+"</td>"};if(count===12){a+="<tr>";for(i=1;i<=6;i++){a+=button(i,render(i))}a+=button("am",i18n.amPm[0]);a+="</tr>";a+="<tr>";for(i=7;i<=12;i++){a+=button(i,render(i))}a+=button("pm",i18n.amPm[1]);a+="</tr>";span=7}else if(count===24){var c=0;for(j=0;j<4;j++){a+="<tr>";for(i=0;i<6;i++){a+=button(c,render(c));c++}a+="</tr>"}span=6}else{a+="<tr>";for(j=0;j<60;j+=10){a+=button(j,render(j),"range")}a+="</tr>";a+='</tbody></thead><table class="'+className+" "+className+'-nospace"><tbody>';var start=range!==null?range:Math.floor(val/10)*10;a+="<tr>";for(j=start+1;j<start+10;j++){a+=button(j,render(j))}a+="</tr>";span=6}container.empty().append('<table class="'+className+'">'+'<thead><tr><th colspan="'+span+'">'+i18n[unit]+"</th></tr></thead>"+"<tbody>"+a+"</tbody>"+"</table>")},_optionsTitle:function(){var i18n=this.c.i18n;var min=this.c.minDate;var max=this.c.maxDate;var minYear=min?min.getFullYear():null;var maxYear=max?max.getFullYear():null;var i=minYear!==null?minYear:(new Date).getFullYear()-this.c.yearRange;var j=maxYear!==null?maxYear:(new Date).getFullYear()+this.c.yearRange;this._options("month",this._range(0,11),i18n.months);this._options("year",this._range(i,j))},_pad:function(i){return i<10?"0"+i:i},_position:function(){var offset=this.c.attachTo==="input"?this.dom.input.position():this.dom.input.offset();var container=this.dom.container;var inputHeight=this.dom.input.outerHeight();if(container.hasClass("inline")){container.insertAfter(this.dom.input);return}if(this.s.parts.date&&this.s.parts.time&&$(window).width()>550){container.addClass("horizontal")}else{container.removeClass("horizontal")}if(this.c.attachTo==="input"){container.css({top:offset.top+inputHeight,left:offset.left}).insertAfter(this.dom.input)}else{container.css({top:offset.top+inputHeight,left:offset.left}).appendTo("body")}var calHeight=container.outerHeight();var calWidth=container.outerWidth();var scrollTop=$(window).scrollTop();if(offset.top+inputHeight+calHeight-scrollTop>$(window).height()){var newTop=offset.top-calHeight;container.css("top",newTop<0?0:newTop)}if(calWidth+offset.left>$(window).width()){var newLeft=$(window).width()-calWidth;if(this.c.attachTo==="input"){newLeft-=$(container).offsetParent().offset().left}container.css("left",newLeft<0?0:newLeft)}},_range:function(start,end,inc){var a=[];if(!inc){inc=1}for(var i=start;i<=end;i+=inc){a.push(i)}return a},_setCalander:function(){if(this.s.display){this.dom.calendar.empty().append(this._htmlMonth(this.s.display.getUTCFullYear(),this.s.display.getUTCMonth()))}},_setTitle:function(){this._optionSet("month",this.s.display.getUTCMonth());this._optionSet("year",this.s.display.getUTCFullYear())},_setTime:function(){var that=this;var d=this.s.d;var hours=d?d.getUTCHours():0;var allowed=function(prop){return that.c[prop+"Available"]?that.c[prop+"Available"]:that._range(0,59,that.c[prop+"Increment"])};this._optionsTime("hours",this.s.parts.hours12?12:24,hours,this.c.hoursAvailable);this._optionsTime("minutes",60,d?d.getUTCMinutes():0,allowed("minutes"),this.s.minutesRange);this._optionsTime("seconds",60,d?d.getSeconds():0,allowed("seconds"),this.s.secondsRange)},_show:function(){var that=this;var namespace=this.s.namespace;this._position();$(window).on("scroll."+namespace+" resize."+namespace,function(){that._hide()});$("div.DTE_Body_Content").on("scroll."+namespace,function(){that._hide()});$("div.dataTables_scrollBody").on("scroll."+namespace,function(){that._hide()});var offsetParent=this.dom.input[0].offsetParent;if(offsetParent!==document.body){$(offsetParent).on("scroll."+namespace,function(){that._hide()})}$(document).on("keydown."+namespace,function(e){if(e.keyCode===9||e.keyCode===27||e.keyCode===13){that._hide()}});setTimeout(function(){$("body").on("click."+namespace,function(e){var parents=$(e.target).parents();if(!parents.filter(that.dom.container).length&&e.target!==that.dom.input[0]){that._hide()}})},10)},_writeOutput:function(focus){var date=this.s.d;var out=dateLib?dateLib.utc(date,undefined$1,this.c.locale,this.c.strict).format(this.c.format):date.getUTCFullYear()+"-"+this._pad(date.getUTCMonth()+1)+"-"+this._pad(date.getUTCDate());this.dom.input.val(out).trigger("change",{write:date});if(this.dom.input.attr("type")==="hidden"){this.val(out,false)}if(focus){this.dom.input.focus()}}});DateTime.use=function(lib){dateLib=lib};DateTime._instance=0;DateTime.defaults={attachTo:"body",classPrefix:"dt-datetime",disableDays:null,firstDay:1,format:"YYYY-MM-DD",hoursAvailable:null,i18n:{previous:"Previous",next:"Next",months:["January","February","March","April","May","June","July","August","September","October","November","December"],weekdays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],amPm:["am","pm"],hours:"Hour",minutes:"Minute",seconds:"Second",unknown:"-"},maxDate:null,minDate:null,minutesAvailable:null,minutesIncrement:1,strict:true,locale:"en",onChange:function(){},secondsAvailable:null,secondsIncrement:1,showWeekNumber:false,yearRange:25};DateTime.version="1.0.1";if(!window.DateTime){window.DateTime=DateTime}$.fn.dtDateTime=function(options){return this.each(function(){new DateTime(this,options)})};if($.fn.dataTable){$.fn.dataTable.DateTime=DateTime;$.fn.DataTable.DateTime=DateTime}return DateTime});var $;var DataTable;var moment=window.moment;function setJQuery(jq){$=jq;DataTable=jq.fn.dataTable}var Criteria=function(){function Criteria(table,opts,topGroup,index,depth){var _this=this;if(index===void 0){index=0}if(depth===void 0){depth=1}if(!DataTable||!DataTable.versionCheck||!DataTable.versionCheck("1.10.0")){throw new Error("SearchPane requires DataTables 1.10 or newer")}this.classes=$.extend(true,{},Criteria.classes);this.c=$.extend(true,{},Criteria.defaults,$.fn.dataTable.ext.searchBuilder,opts);var i18n=this.c.i18n;this.s={condition:undefined,conditions:{},data:undefined,dataIdx:-1,dataPoints:[],depth:depth,dt:table,filled:false,index:index,momentFormat:false,topGroup:topGroup,type:"",value:[]};this.dom={buttons:$("<div/>").addClass(this.classes.buttonContainer),condition:$("<select disabled/>").addClass(this.classes.condition).addClass(this.classes.dropDown).addClass(this.classes.italic).attr("autocomplete","hacking"),conditionTitle:$('<option value="" disabled selected hidden/>').text(this.s.dt.i18n("searchBuilder.condition",i18n.condition)),container:$("<div/>").addClass(this.classes.container),data:$("<select/>").addClass(this.classes.data).addClass(this.classes.dropDown).addClass(this.classes.italic),dataTitle:$('<option value="" disabled selected hidden/>').text(this.s.dt.i18n("searchBuilder.data",i18n.data)),defaultValue:$("<select disabled/>").addClass(this.classes.value).addClass(this.classes.dropDown),delete:$("<button>&times</button>").addClass(this.classes["delete"]).addClass(this.classes.button).attr("title",this.s.dt.i18n("searchBuilder.deleteTitle",i18n.deleteTitle)).attr("type","button"),left:$("<button><</button>").addClass(this.classes.left).addClass(this.classes.button).attr("title",this.s.dt.i18n("searchBuilder.leftTitle",i18n.leftTitle)).attr("type","button"),right:$("<button>></button>").addClass(this.classes.right).addClass(this.classes.button).attr("title",this.s.dt.i18n("searchBuilder.rightTitle",i18n.rightTitle)).attr("type","button"),value:[$("<select disabled/>").addClass(this.classes.value).addClass(this.classes.dropDown).addClass(this.classes.italic)],valueTitle:$('<option value="--valueTitle--" selected/>').text(this.s.dt.i18n("searchBuilder.value",i18n.value))};if(this.c.greyscale){$(this.dom.data).addClass(this.classes.greyscale);$(this.dom.condition).addClass(this.classes.greyscale);$(this.dom.defaultValue).addClass(this.classes.greyscale);for(var _i=0,_a=this.dom.value;_i<_a.length;_i++){var val=_a[_i];$(val).addClass(this.classes.greyscale)}}this.s.dt.on("draw.dtsp",function(){_this._adjustCriteria()});this.s.dt.on("buttons-action",function(){_this._adjustCriteria()});$(window).on("resize.dtsp",DataTable.util.throttle(function(){_this._adjustCriteria()}));this._buildCriteria();return this}Criteria.prototype.updateArrows=function(hasSiblings,redraw){if(hasSiblings===void 0){hasSiblings=false}if(redraw===void 0){redraw=true}$(this.dom.container).empty().append(this.dom.data).append(this.dom.condition).append(this.dom.value[0]);$(this.dom.value[0]).trigger("dtsb-inserted");for(var i=1;i<this.dom.value.length;i++){$(this.dom.container).append(this.dom.value[i]);$(this.dom.value[i]).trigger("dtsb-inserted")}if(this.s.depth>1){$(this.dom.buttons).append(this.dom.left)}if((this.c.depthLimit===false||this.s.depth<this.c.depthLimit)&&hasSiblings){$(this.dom.buttons).append(this.dom.right)}else{$(this.dom.right).remove()}$(this.dom.buttons).append(this.dom["delete"]);$(this.dom.container).append(this.dom.buttons);if(redraw){this._adjustCriteria()}};Criteria.prototype.destroy=function(){$(this.dom.data).off(".dtsb");$(this.dom.condition).off(".dtsb");$(this.dom["delete"]).off(".dtsb");for(var _i=0,_a=this.dom.value;_i<_a.length;_i++){var val=_a[_i];$(val).off(".dtsb")}$(this.dom.container).remove()};Criteria.prototype.search=function(rowData,rowIdx){var condition=this.s.conditions[this.s.condition];if(this.s.condition!==undefined&&condition!==undefined){if(this.s.type.indexOf("num")!==-1&&this.s.dt.settings()[0].oLanguage.sDecimal!==""){rowData[this.s.dataIdx]=rowData[this.s.dataIdx].replace(this.s.dt.settings()[0].oLanguage.sDecimal,".")}var filter=rowData[this.s.dataIdx];if(this.c.orthogonal.search!=="search"){var settings=this.s.dt.settings()[0];filter=settings.oApi._fnGetCellData(settings,rowIdx,this.s.dataIdx,typeof this.c.orthogonal==="string"?this.c.orthogonal:this.c.orthogonal.search)}if(this.s.type==="array"){if(!Array.isArray(filter)){filter=[filter]}filter.sort()}return condition.search(filter,this.s.value,this)}};Criteria.prototype.getDetails=function(){var value=this.s.value;if(this.s.type.indexOf("num")!==-1&&this.s.dt.settings()[0].oLanguage.sDecimal!==""){for(var i=0;i<this.s.value.length;i++){if(this.s.value[i].indexOf(".")!==-1){value[i]=this.s.value[i].replace(".",this.s.dt.settings()[0].oLanguage.sDecimal)}}}return{condition:this.s.condition,data:this.s.data,value:value}};Criteria.prototype.getNode=function(){return this.dom.container};Criteria.prototype.populate=function(){this._populateData();if(this.s.dataIdx!==-1){this._populateCondition();if(this.s.condition!==undefined){this._populateValue()}}};Criteria.prototype.rebuild=function(loadedCriteria){var foundData=false;var dataIdx;this._populateData();if(loadedCriteria.data!==undefined){var italic_1=this.classes.italic;var data_1=this.dom.data;$(this.dom.data).children("option").each(function(){if($(this).text()===loadedCriteria.data){$(this).attr("selected",true);$(data_1).removeClass(italic_1);foundData=true;dataIdx=$(this).val()}})}if(foundData){this.s.data=loadedCriteria.data;this.s.dataIdx=dataIdx;$(this.dom.dataTitle).remove();this._populateCondition();$(this.dom.conditionTitle).remove();var condition_1;$(this.dom.condition).children("option").each(function(){if(loadedCriteria.condition!==undefined&&$(this).val()===loadedCriteria.condition&&typeof loadedCriteria.condition==="string"){$(this).attr("selected",true);condition_1=$(this).val()}});this.s.condition=condition_1;if(this.s.condition!==undefined){$(this.dom.conditionTitle).remove();$(this.dom.condition).removeClass(this.classes.italic);this._populateValue(loadedCriteria)}else{$(this.dom.conditionTitle).prependTo(this.dom.condition).attr("selected",true)}}};Criteria.prototype.setListeners=function(){var _this=this;$(this.dom.data).unbind("input change").on("input change",function(){$(_this.dom.dataTitle).attr("selected",false);$(_this.dom.data).removeClass(_this.classes.italic);_this.s.dataIdx=$(_this.dom.data).children("option:selected").val();_this.s.data=$(_this.dom.data).children("option:selected").text();_this.c.orthogonal=_this._getOptions().orthogonal;_this._clearCondition();_this._clearValue();_this._populateCondition();if(_this.s.filled){_this.s.filled=false;_this.s.dt.draw();_this.setListeners()}_this.s.dt.state.save()});$(this.dom.condition).unbind("input change").on("input change",function(){$(_this.dom.conditionTitle).attr("selected",false);$(_this.dom.condition).removeClass(_this.classes.italic);var condDisp=$(_this.dom.condition).children("option:selected").val();for(var _i=0,_a=Object.keys(_this.s.conditions);_i<_a.length;_i++){var cond=_a[_i];if(cond===condDisp){_this.s.condition=condDisp;break}}_this._clearValue();_this._populateValue();for(var _b=0,_c=_this.dom.value;_b<_c.length;_b++){var val=_c[_b];if(_this.s.filled&&$(_this.dom.container).has(val).length!==0){_this.s.filled=false;_this.s.dt.draw();_this.setListeners()}}_this.s.dt.draw()})};Criteria.prototype._adjustCriteria=function(){if($(document).has(this.dom.container).length===0){return}var valRight;var valWidth;var outmostval=this.dom.value[this.dom.value.length-1];if($(this.dom.container).has(outmostval).length!==0){valWidth=$(outmostval).outerWidth(true);valRight=$(outmostval).offset().left+valWidth}else{return}var leftOffset=$(this.dom.left).offset();var rightOffset=$(this.dom.right).offset();var clearOffset=$(this.dom["delete"]).offset();var hasLeft=$(this.dom.container).has(this.dom.left).length!==0;var hasRight=$(this.dom.container).has(this.dom.right).length!==0;var buttonsLeft=hasLeft?leftOffset.left:hasRight?rightOffset.left:clearOffset.left;if(buttonsLeft-valRight<15||hasLeft&&leftOffset.top!==clearOffset.top||hasRight&&rightOffset.top!==clearOffset.top){$(this.dom.container).parent().addClass(this.classes.vertical);$(this.s.topGroup).trigger("dtsb-redrawContents")}else if(buttonsLeft-($(this.dom.data).offset().left+$(this.dom.data).outerWidth(true)+$(this.dom.condition).outerWidth(true)+valWidth)>15){$(this.dom.container).parent().removeClass(this.classes.vertical);$(this.s.topGroup).trigger("dtsb-redrawContents")}};Criteria.prototype._buildCriteria=function(){$(this.dom.data).append(this.dom.dataTitle);$(this.dom.condition).append(this.dom.conditionTitle);$(this.dom.container).append(this.dom.data).append(this.dom.condition);for(var _i=0,_a=this.dom.value;_i<_a.length;_i++){var val=_a[_i];$(val).append(this.dom.valueTitle);$(this.dom.container).append(val)}$(this.dom.container).append(this.dom["delete"]).append(this.dom.right);this.setListeners()};Criteria.prototype._clearCondition=function(){$(this.dom.condition).empty();$(this.dom.conditionTitle).attr("selected",true).attr("disabled",true);$(this.dom.condition).prepend(this.dom.conditionTitle).prop("selectedIndex",0);this.s.conditions={};this.s.condition=undefined};Criteria.prototype._clearValue=function(){if(this.s.condition!==undefined){for(var _i=0,_a=this.dom.value;_i<_a.length;_i++){var val=_a[_i];$(val).remove()}this.dom.value=[].concat(this.s.conditions[this.s.condition].init(this,Criteria.updateListener));$(this.dom.value[0]).insertAfter(this.dom.condition).trigger("dtsb-inserted");for(var i=1;i<this.dom.value.length;i++){$(this.dom.value[i]).insertAfter(this.dom.value[i-1]).trigger("dtsb-inserted")}}else{for(var _b=0,_c=this.dom.value;_b<_c.length;_b++){var val=_c[_b];$(val).remove()}$(this.dom.valueTitle).attr("selected",true);$(this.dom.defaultValue).append(this.dom.valueTitle).insertAfter(this.dom.condition)}this.s.value=[]};Criteria.prototype._getOptions=function(){var table=this.s.dt;return $.extend(true,{},Criteria.defaults,table.settings()[0].aoColumns[this.s.dataIdx].searchBuilder)};Criteria.prototype._populateCondition=function(){var conditionOpts=[];var conditionsLength=Object.keys(this.s.conditions).length;if(conditionsLength===0){var column=$(this.dom.data).children("option:selected").val();this.s.type=this.s.dt.columns().type().toArray()[column];if(this.s.type===null){this.s.dt.draw();this.setListeners();this.s.type=this.s.dt.columns().type().toArray()[column]}$(this.dom.condition).attr("disabled",false).empty().append(this.dom.conditionTitle).addClass(this.classes.italic);$(this.dom.conditionTitle).attr("selected",true);var decimal=this.s.dt.settings()[0].oLanguage.sDecimal;if(decimal!==""&&this.s.type.indexOf(decimal)===this.s.type.length-decimal.length){if(this.s.type.indexOf("num-fmt")!==-1){this.s.type=this.s.type.replace(decimal,"")}else if(this.s.type.indexOf("num")!==-1){this.s.type=this.s.type.replace(decimal,"")}}var conditionObj=this.c.conditions[this.s.type]!==undefined?this.c.conditions[this.s.type]:this.s.type.indexOf("moment")!==-1?this.c.conditions.moment:this.c.conditions.string;if(this.s.type.indexOf("moment")!==-1){this.s.momentFormat=this.s.type.replace(/moment\-/g,"")}for(var _i=0,_a=Object.keys(conditionObj);_i<_a.length;_i++){var condition=_a[_i];if(conditionObj[condition]!==null){this.s.conditions[condition]=conditionObj[condition];var condName=conditionObj[condition].conditionName;if(typeof condName==="function"){condName=condName(this.s.dt,this.c.i18n)}conditionOpts.push($("<option>",{text:condName,value:condition}).addClass(this.classes.option).addClass(this.classes.notItalic))}}}else if(conditionsLength>0){$(this.dom.condition).empty().attr("disabled",false).addClass(this.classes.italic);for(var _b=0,_c=Object.keys(this.s.conditions);_b<_c.length;_b++){var condition=_c[_b];var condName=this.s.conditions[condition].conditionName;if(typeof condName==="function"){condName=condName(this.s.dt,this.c.i18n)}var newOpt=$("<option>",{text:condName,value:condition}).addClass(this.classes.option).addClass(this.classes.notItalic);if(this.s.condition!==undefined&&this.s.condition===condName){$(newOpt).attr("selected",true);$(this.dom.condition).removeClass(this.classes.italic)}conditionOpts.push(newOpt)}}else{$(this.dom.condition).attr("disabled",true).addClass(this.classes.italic);return}for(var _d=0,conditionOpts_1=conditionOpts;_d<conditionOpts_1.length;_d++){var opt=conditionOpts_1[_d];$(this.dom.condition).append(opt)}$(this.dom.condition).prop("selectedIndex",0)};Criteria.prototype._populateData=function(){var _this=this;$(this.dom.data).empty().append(this.dom.dataTitle);if(this.s.dataPoints.length===0){this.s.dt.columns().every(function(index){if(_this.c.columns===true||_this.s.dt.columns(_this.c.columns).indexes().toArray().indexOf(index)!==-1){var found=false;for(var _i=0,_a=_this.s.dataPoints;_i<_a.length;_i++){var val=_a[_i];if(val.index===index){found=true;break}}if(!found){var opt={text:_this.s.dt.settings()[0].aoColumns[index].sTitle,index:index};_this.s.dataPoints.push(opt);$(_this.dom.data).append($("<option>",{text:opt.text,value:opt.index}).addClass(_this.classes.option).addClass(_this.classes.notItalic))}}})}else{var _loop_1=function(data){this_1.s.dt.columns().every(function(index){if(_this.s.dt.settings()[0].aoColumns[index].sTitle===data.text){data.index=index}});var newOpt=$("<option>",{text:data.text,value:data.index}).addClass(this_1.classes.option).addClass(this_1.classes.notItalic);if(this_1.s.data===data.text){this_1.s.dataIdx=data.index;$(newOpt).attr("selected",true);$(this_1.dom.data).removeClass(this_1.classes.italic)}$(this_1.dom.data).append(newOpt)};var this_1=this;for(var _i=0,_a=this.s.dataPoints;_i<_a.length;_i++){var data=_a[_i];_loop_1(data)}}};Criteria.prototype._populateValue=function(loadedCriteria){var _this=this;var prevFilled=this.s.filled;this.s.filled=false;$(this.dom.defaultValue).remove();for(var _i=0,_a=this.dom.value;_i<_a.length;_i++){var val=_a[_i];$(val).remove()}var children=$(this.dom.container).children();if(children.length>3){for(var i=2;i<children.length-1;i++){$(children[i]).remove()}}if(loadedCriteria!==undefined){this.s.dt.columns().every(function(index){if(_this.s.dt.settings()[0].aoColumns[index].sTitle===loadedCriteria.data){_this.s.dataIdx=index}})}this.dom.value=[].concat(this.s.conditions[this.s.condition].init(this,Criteria.updateListener,loadedCriteria!==undefined?loadedCriteria.value:undefined));if(loadedCriteria!==undefined&&loadedCriteria.value!==undefined){this.s.value=loadedCriteria.value}$(this.dom.value[0]).insertAfter(this.dom.condition).trigger("dtsb-inserted");for(var i=1;i<this.dom.value.length;i++){$(this.dom.value[i]).insertAfter(this.dom.value[i-1]).trigger("dtsb-inserted")}this.s.filled=this.s.conditions[this.s.condition].isInputValid(this.dom.value,this);this.setListeners();if(prevFilled!==this.s.filled){this.s.dt.draw();this.setListeners()}};Criteria.version="1.0.0";Criteria.classes={button:"dtsb-button",buttonContainer:"dtsb-buttonContainer",condition:"dtsb-condition",container:"dtsb-criteria",data:"dtsb-data",delete:"dtsb-delete",dropDown:"dtsb-dropDown",greyscale:"dtsb-greyscale",input:"dtsb-input",italic:"dtsb-italic",joiner:"dtsp-joiner",left:"dtsb-left",notItalic:"dtsb-notItalic",option:"dtsb-option",right:"dtsb-right",value:"dtsb-value",vertical:"dtsb-vertical"};Criteria.initSelect=function(that,fn,preDefined,array){if(preDefined===void 0){preDefined=null}if(array===void 0){array=false}var column=$(that.dom.data).children("option:selected").val();var indexArray=that.s.dt.rows().indexes().toArray();var settings=that.s.dt.settings()[0];var el=$("<select/>").addClass(Criteria.classes.value).addClass(Criteria.classes.dropDown).addClass(Criteria.classes.italic).append(that.dom.valueTitle).on("input change",function(){$(this).removeClass(Criteria.classes.italic);fn(that,this)});if(that.c.greyscale){$(el).addClass(Criteria.classes.greyscale)}var added=[];var options=[];for(var _i=0,indexArray_1=indexArray;_i<indexArray_1.length;_i++){var index=indexArray_1[_i];var filter=settings.oApi._fnGetCellData(settings,index,column,typeof that.c.orthogonal==="string"?that.c.orthogonal:that.c.orthogonal.search);var value={filter:typeof filter==="string"?filter.replace(/[\r\n\u2028]/g," "):filter,index:index,text:settings.oApi._fnGetCellData(settings,index,column,typeof that.c.orthogonal==="string"?that.c.orthogonal:that.c.orthogonal.display)};if(that.s.type==="array"){value.filter=!Array.isArray(value.filter)?[value.filter]:value.filter=value.filter.sort();value.text=!Array.isArray(value.text)?[value.text]:value.text=value.text.sort()}var addOption=function(filt,text){var opt=$("<option>",{text:typeof text==="string"?text.replace(/(<([^>]+)>)/gi,""):text,type:Array.isArray(filt)?"Array":"String",value:that.s.type.indexOf("html")!==-1&&filt!==null&&typeof filt==="string"?filt.replace(/(<([^>]+)>)/gi,""):filt}).addClass(that.classes.option).addClass(that.classes.notItalic);var val=$(opt).val();if(added.indexOf(val)===-1){added.push(val);options.push(opt);if(preDefined!==null&&Array.isArray(preDefined[0])){preDefined[0]=preDefined[0].sort().join(",")}if(preDefined!==null&&opt.val()===preDefined[0]){opt.attr("selected",true);$(el).removeClass(Criteria.classes.italic)}}};if(array){for(var i=0;i<value.filter.length;i++){addOption(value.filter[i],value.text[i])}}else{addOption(value.filter,value.text)}}options.sort(function(a,b){if(that.s.type==="string"||that.s.type==="num"||that.s.type==="html"||that.s.type==="html-num"){if($(a).val()<$(b).val()){return-1}else if($(a).val()<$(b).val()){return 1}else{return 0}}else if(that.s.type==="num-fmt"||that.s.type==="html-num-fmt"){if(+$(a).val().replace(/[^0-9.]/g,"")<+$(b).val().replace(/[^0-9.]/g,"")){return-1}else if(+$(a).val().replace(/[^0-9.]/g,"")<+$(b).val().replace(/[^0-9.]/g,"")){return 1}else{return 0}}});for(var _a=0,options_1=options;_a<options_1.length;_a++){var opt=options_1[_a];$(el).append(opt)}return el};Criteria.initSelectArray=function(that,fn,preDefined){if(preDefined===void 0){preDefined=null}return Criteria.initSelect(that,fn,preDefined,true)};Criteria.initInput=function(that,fn,preDefined){if(preDefined===void 0){preDefined=null}var el=$("<input/>").addClass(Criteria.classes.value).addClass(Criteria.classes.input).on("input",function(){fn(that,this)});if(that.c.greyscale){$(el).addClass(Criteria.classes.greyscale)}if(preDefined!==null){$(el).val(preDefined[0])}return el};Criteria.init2Input=function(that,fn,preDefined){if(preDefined===void 0){preDefined=null}var els=[$("<input/>").addClass(Criteria.classes.value).addClass(Criteria.classes.input).on("input",function(){fn(that,this)}),$("<span>").addClass(that.classes.joiner).text(that.s.dt.i18n("searchBuilder.valueJoiner",that.c.i18n.valueJoiner)),$("<input/>").addClass(Criteria.classes.value).addClass(Criteria.classes.input).on("input",function(){fn(that,this)})];if(that.c.greyscale){$(els[0]).addClass(Criteria.classes.greyscale);$(els[2]).addClass(Criteria.classes.greyscale)}if(preDefined!==null){$(els[0]).val(preDefined[0]);$(els[2]).val(preDefined[1])}that.s.dt.off("draw");that.s.dt.one("draw",function(){$(that.s.topGroup).trigger("dtsb-redrawContents")});return els};Criteria.initDate=function(that,fn,preDefined){if(preDefined===void 0){preDefined=null}var el=$("<input/>").addClass(Criteria.classes.value).addClass(Criteria.classes.input).dtDateTime({attachTo:"input",format:that.s.momentFormat?that.s.momentFormat:undefined}).on("input change",function(){fn(that,this)});if(that.c.greyscale){$(el).addClass(Criteria.classes.greyscale)}if(preDefined!==null){$(el).val(preDefined[0])}return el};Criteria.initNoValue=function(that){that.s.dt.off("draw");that.s.dt.one("draw",function(){$(that.s.topGroup).trigger("dtsb-redrawContents")})};Criteria.init2Date=function(that,fn,preDefined){if(preDefined===void 0){preDefined=null}var els=[$("<input/>").addClass(Criteria.classes.value).addClass(Criteria.classes.input).dtDateTime({attachTo:"input",format:that.s.momentFormat?that.s.momentFormat:undefined}).on("input change",function(){fn(that,this)}),$("<span>").addClass(that.classes.joiner).text(that.s.dt.i18n("searchBuilder.valueJoiner",that.c.i18n.valueJoiner)),$("<input/>").addClass(Criteria.classes.value).addClass(Criteria.classes.input).dtDateTime({attachTo:"input",format:that.s.momentFormat?that.s.momentFormat:undefined}).on("input change",function(){fn(that,this)})];if(that.c.greyscale){$(els[0]).addClass(Criteria.classes.greyscale);$(els[2]).addClass(Criteria.classes.greyscale)}if(preDefined!==null&&preDefined.length>0){$(els[0]).val(preDefined[0]);$(els[2]).val(preDefined[1])}that.s.dt.off("draw");that.s.dt.one("draw",function(){$(that.s.topGroup).trigger("dtsb-redrawContents")});return els};Criteria.isInputValidSelect=function(el){var allFilled=true;for(var _i=0,el_1=el;_i<el_1.length;_i++){var element=el_1[_i];if($(element).children("option:selected").length===$(element).children("option").length-$(element).children("option."+Criteria.classes.notItalic).length&&$(element).children("option:selected").length===1&&$(element).children("option:selected")[0]===$(element).children("option:hidden")[0]){allFilled=false}}return allFilled};Criteria.isInputValidInput=function(el){var allFilled=true;for(var _i=0,el_2=el;_i<el_2.length;_i++){var element=el_2[_i];if($(element).is("input")&&$(element).val().length===0){allFilled=false}}return allFilled};Criteria.inputValueSelect=function(el){var values=[];for(var _i=0,el_3=el;_i<el_3.length;_i++){var element=el_3[_i];if($(element).is("select")){var val=$(element).children("option:selected").val();values.push($(element).children("option:selected").attr("type")==="Array"?val.split(",").sort():val)}}return values};Criteria.inputValueInput=function(el){var values=[];for(var _i=0,el_4=el;_i<el_4.length;_i++){var element=el_4[_i];if($(element).is("input")){values.push($(element).val())}}return values};Criteria.updateListener=function(that,el){var condition=that.s.conditions[that.s.condition];that.s.filled=condition.isInputValid(that.dom.value,that);that.s.value=condition.inputValue(that.dom.value,that);if(!Array.isArray(that.s.value)){that.s.value=[that.s.value]}for(var i=0;i<that.s.value.length;i++){if(Array.isArray(that.s.value[i])){that.s.value[i].sort()}else if(that.s.dt.settings()[0].oLanguage.sDecimal!==""){that.s.value[i]=that.s.value[i].replace(that.s.dt.settings()[0].oLanguage.sDecimal,".")}}var idx=null;var cursorPos=null;for(var i=0;i<that.dom.value.length;i++){if(el===that.dom.value[i][0]){idx=i;if(el.selectionStart!==undefined){cursorPos=el.selectionStart}}}that.s.dt.draw();if(idx!==null){$(that.dom.value[idx]).removeClass(that.classes.italic);$(that.dom.value[idx]).focus();if(cursorPos!==null){$(that.dom.value[idx])[0].setSelectionRange(cursorPos,cursorPos)}}};Criteria.dateConditions={"=":{conditionName:function(dt,i18n){return dt.i18n("searchBuilder.conditions.date.equals",i18n.conditions.date.equals)},init:Criteria.initDate,inputValue:Criteria.inputValueInput,isInputValid:Criteria.isInputValidInput,search:function(value,comparison){value=value.replace(/(\/|\-|\,)/g,"-");return value===comparison[0]}},"!=":{conditionName:function(dt,i18n){return dt.i18n("searchBuilder.conditions.date.not",i18n.conditions.date.not)},init:Criteria.initDate,inputValue:Criteria.inputValueInput,isInputValid:Criteria.isInputValidInput,search:function(value,comparison){value=value.replace(/(\/|\-|\,)/g,"-");return value!==comparison[0]}},"<":{conditionName:function(dt,i18n){return dt.i18n("searchBuilder.conditions.date.before",i18n.conditions.date.before)},init:Criteria.initDate,inputValue:Criteria.inputValueInput,isInputValid:Criteria.isInputValidInput,search:function(value,comparison){value=value.replace(/(\/|\-|\,)/g,"-");return value<comparison[0]}},">":{conditionName:function(dt,i18n){return dt.i18n("searchBuilder.conditions.date.after",i18n.conditions.date.after)},init:Criteria.initDate,inputValue:Criteria.inputValueInput,isInputValid:Criteria.isInputValidInput,search:function(value,comparison){value=value.replace(/(\/|\-|\,)/g,"-");return value>comparison[0]}},between:{conditionName:function(dt,i18n){return dt.i18n("searchBuilder.conditions.date.between",i18n.conditions.date.between)},init:Criteria.init2Date,inputValue:Criteria.inputValueInput,isInputValid:Criteria.isInputValidInput,search:function(value,comparison){value=value.replace(/(\/|\-|\,)/g,"-");if(comparison[0]<comparison[1]){return comparison[0]<=value&&value<=comparison[1]}else{return comparison[1]<=value&&value<=comparison[0]}}},"!between":{conditionName:function(dt,i18n){return dt.i18n("searchBuilder.conditions.date.notBetween",i18n.conditions.date.notBetween)},init:Criteria.init2Date,inputValue:Criteria.inputValueInput,isInputValid:Criteria.isInputValidInput,search:function(value,comparison){value=value.replace(/(\/|\-|\,)/g,"-");if(comparison[0]<comparison[1]){return!(comparison[0]<=value&&value<=comparison[1])}else{return!(comparison[1]<=value&&value<=comparison[0])}}},null:{conditionName:function(dt,i18n){return dt.i18n("searchBuilder.conditions.date.empty",i18n.conditions.date.empty)},isInputValid:function(){return true},init:Criteria.initNoValue,inputValue:function(){return},search:function(value){return value===null||value===undefined||value.length===0}},"!null":{conditionName:function(dt,i18n){return dt.i18n("searchBuilder.conditions.date.notEmpty",i18n.conditions.date.notEmpty)},isInputValid:function(){return true},init:Criteria.initNoValue,inputValue:function(){return},search:function(value){return!(value===null||value===undefined||value.length===0)}}};Criteria.momentDateConditions={"=":{conditionName:function(dt,i18n){return dt.i18n("searchBuilder.conditions.moment.equals",i18n.conditions.moment.equals)},init:Criteria.initDate,inputValue:Criteria.inputValueInput,isInputValid:Criteria.isInputValidInput,search:function(value,comparison,that){return moment(value,that.s.momentFormat).valueOf()===moment(comparison[0],that.s.momentFormat).valueOf()}},"!=":{conditionName:function(dt,i18n){return dt.i18n("searchBuilder.conditions.moment.not",i18n.conditions.moment.not)},init:Criteria.initDate,inputValue:Criteria.inputValueInput,isInputValid:Criteria.isInputValidInput,search:function(value,comparison,that){return moment(value,that.s.momentFormat).valueOf()!==moment(comparison[0],that.s.momentFormat).valueOf()}},"<":{conditionName:function(dt,i18n){return dt.i18n("searchBuilder.conditions.moment.before",i18n.conditions.moment.before)},init:Criteria.initDate,inputValue:Criteria.inputValueInput,isInputValid:Criteria.isInputValidInput,search:function(value,comparison,that){return moment(value,that.s.momentFormat).valueOf()<moment(comparison[0],that.s.momentFormat).valueOf()}},">":{conditionName:function(dt,i18n){return dt.i18n("searchBuilder.conditions.moment.after",i18n.conditions.moment.after)},init:Criteria.initDate,inputValue:Criteria.inputValueInput,isInputValid:Criteria.isInputValidInput,search:function(value,comparison,that){return moment(value,that.s.momentFormat).valueOf()>moment(comparison[0],that.s.momentFormat).valueOf()}},between:{conditionName:function(dt,i18n){return dt.i18n("searchBuilder.conditions.moment.between",i18n.conditions.moment.between)},init:Criteria.init2Date,inputValue:Criteria.inputValueInput,isInputValid:Criteria.isInputValidInput,search:function(value,comparison,that){var val=moment(value,that.s.momentFormat).valueOf();var comp0=moment(comparison[0],that.s.momentFormat).valueOf();var comp1=moment(comparison[1],that.s.momentFormat).valueOf();if(comp0<comp1){return comp0<=val&&val<=comp1}else{return comp1<=val&&val<=comp0}}},"!between":{conditionName:function(dt,i18n){return dt.i18n("searchBuilder.conditions.moment.notBetween",i18n.conditions.moment.notBetween)},init:Criteria.init2Date,inputValue:Criteria.inputValueInput,isInputValid:Criteria.isInputValidInput,search:function(value,comparison,that){var val=moment(value,that.s.momentFormat).valueOf();var comp0=moment(comparison[0],that.s.momentFormat).valueOf();var comp1=moment(comparison[1],that.s.momentFormat).valueOf();if(comp0<comp1){return!(+comp0<=+val&&+val<=+comp1)}else{return!(+comp1<=+val&&+val<=+comp0)}}},null:{conditionName:function(dt,i18n){return dt.i18n("searchBuilder.conditions.moment.empty",i18n.conditions.moment.empty)},isInputValid:function(){return true},init:Criteria.initNoValue,inputValue:function(){return},search:function(value){return value===null||value===undefined||value.length===0}},"!null":{conditionName:function(dt,i18n){return dt.i18n("searchBuilder.conditions.moment.notEmpty",i18n.conditions.moment.notEmpty)},isInputValid:function(){return true},init:Criteria.initNoValue,inputValue:function(){return},search:function(value){return!(value===null||value===undefined||value.length===0)}}};Criteria.numConditions={"=":{conditionName:function(dt,i18n){return dt.i18n("searchBuilder.conditions.number.equals",i18n.conditions.number.equals)},init:Criteria.initSelect,inputValue:Criteria.inputValueSelect,isInputValid:Criteria.isInputValidSelect,search:function(value,comparison){return+value===+comparison[0]}},"!=":{conditionName:function(dt,i18n){return dt.i18n("searchBuilder.conditions.number.not",i18n.conditions.number.not)},init:Criteria.initSelect,inputValue:Criteria.inputValueSelect,isInputValid:Criteria.isInputValidSelect,search:function(value,comparison){return+value!==+comparison[0]}},"<":{conditionName:function(dt,i18n){return dt.i18n("searchBuilder.conditions.number.lt",i18n.conditions.number.lt)},init:Criteria.initInput,inputValue:Criteria.inputValueInput,isInputValid:Criteria.isInputValidInput,search:function(value,comparison){return+value<+comparison[0]}},"<=":{conditionName:function(dt,i18n){return dt.i18n("searchBuilder.conditions.number.lte",i18n.conditions.number.lte)},init:Criteria.initInput,inputValue:Criteria.inputValueInput,isInputValid:Criteria.isInputValidInput,search:function(value,comparison){return+value<=+comparison[0]}},">=":{conditionName:function(dt,i18n){return dt.i18n("searchBuilder.conditions.number.gte",i18n.conditions.number.gte)},init:Criteria.initInput,inputValue:Criteria.inputValueInput,isInputValid:Criteria.isInputValidInput,search:function(value,comparison){return+value>=+comparison[0]}},">":{conditionName:function(dt,i18n){return dt.i18n("searchBuilder.conditions.number.gt",i18n.conditions.number.gt)},init:Criteria.initInput,inputValue:Criteria.inputValueInput,isInputValid:Criteria.isInputValidInput,search:function(value,comparison){return+value>+comparison[0]}},between:{conditionName:function(dt,i18n){return dt.i18n("searchBuilder.conditions.number.between",i18n.conditions.number.between)},init:Criteria.init2Input,inputValue:Criteria.inputValueInput,isInputValid:Criteria.isInputValidInput,search:function(value,comparison){if(+comparison[0]<+comparison[1]){return+comparison[0]<=+value&&+value<=+comparison[1]}else{return+comparison[1]<=+value&&+value<=+comparison[0]}}},"!between":{conditionName:function(dt,i18n){return dt.i18n("searchBuilder.conditions.number.notBetween",i18n.conditions.number.notBetween)},init:Criteria.init2Input,inputValue:Criteria.inputValueInput,isInputValid:Criteria.isInputValidInput,search:function(value,comparison){if(+comparison[0]<+comparison[1]){return!(+comparison[0]<=+value&&+value<=+comparison[1])}else{return!(+comparison[1]<=+value&&+value<=+comparison[0])}}},null:{conditionName:function(dt,i18n){return dt.i18n("searchBuilder.conditions.number.empty",i18n.conditions.number.empty)},init:Criteria.initNoValue,inputValue:function(){return},isInputValid:function(){return true},search:function(value){return value===null||value===undefined||value.length===0}},"!null":{conditionName:function(dt,i18n){return dt.i18n("searchBuilder.conditions.number.notEmpty",i18n.conditions.number.notEmpty)},isInputValid:function(){return true},init:Criteria.initNoValue,inputValue:function(){return},search:function(value){return!(value===null||value===undefined||value.length===0)}}};Criteria.numFmtConditions={"=":{conditionName:function(dt,i18n){return dt.i18n("searchBuilder.conditions.number.equals",i18n.conditions.number.equals)},init:Criteria.initSelect,inputValue:Criteria.inputValueSelect,isInputValid:Criteria.isInputValidSelect,search:function(value,comparison){var val=value.indexOf("-")===0?"-"+value.replace(/[^0-9.]/g,""):value.replace(/[^0-9.]/g,"");var comp=comparison[0].indexOf("-")===0?"-"+comparison[0].replace(/[^0-9.]/g,""):comparison[0].replace(/[^0-9.]/g,"");return+val===+comp}},"!=":{conditionName:function(dt,i18n){return dt.i18n("searchBuilder.conditions.number.not",i18n.conditions.number.not)},init:Criteria.initSelect,inputValue:Criteria.inputValueSelect,isInputValid:Criteria.isInputValidSelect,search:function(value,comparison){var val=value.indexOf("-")===0?"-"+value.replace(/[^0-9.]/g,""):value.replace(/[^0-9.]/g,"");var comp=comparison[0].indexOf("-")===0?"-"+comparison[0].replace(/[^0-9.]/g,""):comparison[0].replace(/[^0-9.]/g,"");return+val!==+comp}},"<":{conditionName:function(dt,i18n){return dt.i18n("searchBuilder.conditions.number.lt",i18n.conditions.number.lt)},init:Criteria.initInput,inputValue:Criteria.inputValueInput,isInputValid:Criteria.isInputValidInput,search:function(value,comparison){var val=value.indexOf("-")===0?"-"+value.replace(/[^0-9.]/g,""):value.replace(/[^0-9.]/g,"");var comp=comparison[0].indexOf("-")===0?"-"+comparison[0].replace(/[^0-9.]/g,""):comparison[0].replace(/[^0-9.]/g,"");return+val<+comp}},"<=":{conditionName:function(dt,i18n){return dt.i18n("searchBuilder.conditions.number.lte",i18n.conditions.number.lte)},init:Criteria.initInput,inputValue:Criteria.inputValueInput,isInputValid:Criteria.isInputValidInput,search:function(value,comparison){var val=value.indexOf("-")===0?"-"+value.replace(/[^0-9.]/g,""):value.replace(/[^0-9.]/g,"");var comp=comparison[0].indexOf("-")===0?"-"+comparison[0].replace(/[^0-9.]/g,""):comparison[0].replace(/[^0-9.]/g,"");return+val<=+comp}},">=":{conditionName:function(dt,i18n){return dt.i18n("searchBuilder.conditions.number.gte",i18n.conditions.number.gte)},init:Criteria.initInput,inputValue:Criteria.inputValueInput,isInputValid:Criteria.isInputValidInput,search:function(value,comparison){var val=value.indexOf("-")===0?"-"+value.replace(/[^0-9.]/g,""):value.replace(/[^0-9.]/g,"");var comp=comparison[0].indexOf("-")===0?"-"+comparison[0].replace(/[^0-9.]/g,""):comparison[0].replace(/[^0-9.]/g,"");return+val>=+comp}},">":{conditionName:function(dt,i18n){return dt.i18n("searchBuilder.conditions.number.gt",i18n.conditions.number.gt)},init:Criteria.initInput,inputValue:Criteria.inputValueInput,isInputValid:Criteria.isInputValidInput,search:function(value,comparison){var val=value.indexOf("-")===0?"-"+value.replace(/[^0-9.]/g,""):value.replace(/[^0-9.]/g,"");var comp=comparison[0].indexOf("-")===0?"-"+comparison[0].replace(/[^0-9.]/g,""):comparison[0].replace(/[^0-9.]/g,"");return+val>+comp}},between:{conditionName:function(dt,i18n){return dt.i18n("searchBuilder.conditions.number.between",i18n.conditions.number.between)},init:Criteria.init2Input,inputValue:Criteria.inputValueInput,isInputValid:Criteria.isInputValidInput,search:function(value,comparison){var val=value.indexOf("-")===0?"-"+value.replace(/[^0-9.]/g,""):value.replace(/[^0-9.]/g,"");var comp0=comparison[0].indexOf("-")===0?"-"+comparison[0].replace(/[^0-9.]/g,""):comparison[0].replace(/[^0-9.]/g,"");var comp1=comparison[1].indexOf("-")===0?"-"+comparison[1].replace(/[^0-9.]/g,""):comparison[1].replace(/[^0-9.]/g,"");if(+comp0<+comp1){return+comp0<=+val&&+val<=+comp1}else{return+comp1<=+val&&+val<=+comp0}}},"!between":{conditionName:function(dt,i18n){return dt.i18n("searchBuilder.conditions.number.notBetween",i18n.conditions.number.notBetween)},init:Criteria.init2Input,inputValue:Criteria.inputValueInput,isInputValid:Criteria.isInputValidInput,search:function(value,comparison){var val=value.indexOf("-")===0?"-"+value.replace(/[^0-9.]/g,""):value.replace(/[^0-9.]/g,"");var comp0=comparison[0].indexOf("-")===0?"-"+comparison[0].replace(/[^0-9.]/g,""):comparison[0].replace(/[^0-9.]/g,"");var comp1=comparison[1].indexOf("-")===0?"-"+comparison[1].replace(/[^0-9.]/g,""):comparison[1].replace(/[^0-9.]/g,"");if(+comp0<+comp1){return!(+comp0<=+val&&+val<=+comp1)}else{return!(+comp1<=+val&&+val<=+comp0)}}},null:{conditionName:function(dt,i18n){return dt.i18n("searchBuilder.conditions.number.empty",i18n.conditions.number.empty)},init:Criteria.initNoValue,inputValue:function(){return},isInputValid:function(){return true},search:function(value){return value===null||value===undefined||value.length===0}},"!null":{conditionName:function(dt,i18n){return dt.i18n("searchBuilder.conditions.number.notEmpty",i18n.conditions.number.notEmpty)},isInputValid:function(){return true},init:Criteria.initNoValue,inputValue:function(){return},search:function(value){return!(value===null||value===undefined||value.length===0)}}};Criteria.stringConditions={"=":{conditionName:function(dt,i18n){return dt.i18n("searchBuilder.conditions.string.equals",i18n.conditions.string.equals)},init:Criteria.initSelect,inputValue:Criteria.inputValueSelect,isInputValid:Criteria.isInputValidSelect,search:function(value,comparison){return value===comparison[0]}},"!=":{conditionName:function(dt,i18n){return dt.i18n("searchBuilder.conditions.string.not",i18n.conditions.string.not)},init:Criteria.initSelect,inputValue:Criteria.inputValueSelect,isInputValid:Criteria.isInputValidInput,search:function(value,comparison){return value!==comparison[0]}},starts:{conditionName:function(dt,i18n){return dt.i18n("searchBuilder.conditions.string.startsWith",i18n.conditions.string.startsWith)},init:Criteria.initInput,inputValue:Criteria.inputValueInput,isInputValid:Criteria.isInputValidInput,search:function(value,comparison){return value.toLowerCase().indexOf(comparison[0].toLowerCase())===0}},contains:{conditionName:function(dt,i18n){return dt.i18n("searchBuilder.conditions.string.contains",i18n.conditions.string.contains)},init:Criteria.initInput,inputValue:Criteria.inputValueInput,isInputValid:Criteria.isInputValidInput,search:function(value,comparison){return value.toLowerCase().indexOf(comparison[0].toLowerCase())!==-1}},ends:{conditionName:function(dt,i18n){return dt.i18n("searchBuilder.conditions.string.endsWith",i18n.conditions.string.endsWith)},init:Criteria.initInput,inputValue:Criteria.inputValueInput,isInputValid:Criteria.isInputValidInput,search:function(value,comparison){return value.toLowerCase().endsWith(comparison[0].toLowerCase())}},null:{conditionName:function(dt,i18n){return dt.i18n("searchBuilder.conditions.string.empty",i18n.conditions.string.empty)},init:Criteria.initNoValue,inputValue:function(){return},isInputValid:function(){return true},search:function(value){return value===null||value===undefined||value.length===0}},"!null":{conditionName:function(dt,i18n){return dt.i18n("searchBuilder.conditions.string.notEmpty",i18n.conditions.string.notEmpty)},isInputValid:function(){return true},init:Criteria.initNoValue,inputValue:function(){return},search:function(value){return!(value===null||value===undefined||value.length===0)}}};Criteria.arrayConditions={contains:{conditionName:function(dt,i18n){return dt.i18n("searchBuilder.conditions.array.contains",i18n.conditions.array.contains)},init:Criteria.initSelectArray,inputValue:Criteria.inputValueSelect,isInputValid:Criteria.isInputValidSelect,search:function(value,comparison){return value.indexOf(comparison[0])!==-1}},without:{conditionName:function(dt,i18n){return dt.i18n("searchBuilder.conditions.array.without",i18n.conditions.array.without)},init:Criteria.initSelectArray,inputValue:Criteria.inputValueSelect,isInputValid:Criteria.isInputValidSelect,search:function(value,comparison){return value.indexOf(comparison[0])===-1}},"=":{conditionName:function(dt,i18n){return dt.i18n("searchBuilder.conditions.array.equals",i18n.conditions.array.equals)},init:Criteria.initSelect,inputValue:Criteria.inputValueSelect,isInputValid:Criteria.isInputValidSelect,search:function(value,comparison){if(value.length===comparison[0].length){for(var i=0;i<value.length;i++){if(value[i]!==comparison[0][i]){return false}}return true}return false}},"!=":{conditionName:function(dt,i18n){return dt.i18n("searchBuilder.conditions.array.not",i18n.conditions.array.not)},init:Criteria.initSelect,inputValue:Criteria.inputValueSelect,isInputValid:Criteria.isInputValidSelect,search:function(value,comparison){if(value.length===comparison[0].length){for(var i=0;i<value.length;i++){if(value[i]!==comparison[0][i]){return true}}return false}return true}},null:{conditionName:function(dt,i18n){return dt.i18n("searchBuilder.conditions.array.empty",i18n.conditions.array.empty)},init:Criteria.initNoValue,isInputValid:function(){return true},inputValue:function(){return},search:function(value){return value===null||value===undefined||value.length===0}},"!null":{conditionName:function(dt,i18n){return dt.i18n("searchBuilder.conditions.array.notEmpty",i18n.conditions.array.notEmpty)},isInputValid:function(){return true},init:Criteria.initNoValue,inputValue:function(){return},search:function(value){return value!==null&&value!==undefined&&value.length!==0}}};Criteria.defaults={columns:true,conditions:{array:Criteria.arrayConditions,date:Criteria.dateConditions,html:Criteria.stringConditions,"html-num":Criteria.numConditions,"html-num-fmt":Criteria.numFmtConditions,moment:Criteria.momentDateConditions,num:Criteria.numConditions,"num-fmt":Criteria.numFmtConditions,string:Criteria.stringConditions},depthLimit:false,filterChanged:undefined,greyscale:false,i18n:{add:"Add Condition",button:{0:"Search Builder",_:"Search Builder (%d)"},clearAll:"Clear All",condition:"Condition",data:"Data",deleteTitle:"Delete filtering rule",leftTitle:"Outdent criteria",logicAnd:"And",logicOr:"Or",rightTitle:"Indent criteria",title:{0:"Custom Search Builder",_:"Custom Search Builder (%d)"},value:"Value",valueJoiner:"and"},logic:"AND",orthogonal:{display:"display",search:"filter"},preDefined:false};return Criteria}();var $$1;var DataTable$1;function setJQuery$1(jq){$$1=jq;DataTable$1=jq.fn.dataTable}var Group=function(){function Group(table,opts,topGroup,index,isChild,depth){if(index===void 0){index=0}if(isChild===void 0){isChild=false}if(depth===void 0){depth=1}if(!DataTable$1||!DataTable$1.versionCheck||!DataTable$1.versionCheck("1.10.0")){throw new Error("SearchBuilder requires DataTables 1.10 or newer")}this.classes=$$1.extend(true,{},Group.classes);this.c=$$1.extend(true,{},Group.defaults,opts);this.s={criteria:[],depth:depth,dt:table,index:index,isChild:isChild,logic:undefined,opts:opts,toDrop:undefined,topGroup:topGroup};this.dom={add:$$1("<button/>").addClass(this.classes.add).addClass(this.classes.button).attr("type","button"),clear:$$1("<button>&times</button>").addClass(this.classes.button).addClass(this.classes.clearGroup).attr("type","button"),container:$$1("<div/>").addClass(this.classes.group),logic:$$1("<button/>").addClass(this.classes.logic).addClass(this.classes.button).attr("type","button"),logicContainer:$$1("<div/>").addClass(this.classes.logicContainer)};if(this.s.topGroup===undefined){this.s.topGroup=this.dom.container}this._setup();return this}Group.prototype.destroy=function(){$$1(this.dom.add).off(".dtsb");$$1(this.dom.logic).off(".dtsb");$$1(this.dom.container).trigger("dtsb-destroy").remove();this.s.criteria=[]};Group.prototype.getDetails=function(){if(this.s.criteria.length===0){return{}}var details={criteria:[],logic:this.s.logic};for(var _i=0,_a=this.s.criteria;_i<_a.length;_i++){var crit=_a[_i];details.criteria.push(crit.criteria.getDetails())}return details};Group.prototype.getNode=function(){return this.dom.container};Group.prototype.rebuild=function(loadedDetails){if(loadedDetails.criteria===undefined||loadedDetails.criteria===null||loadedDetails.criteria.length===0){return}this.s.logic=loadedDetails.logic;$$1(this.dom.logic).text(this.s.logic==="OR"?this.s.dt.i18n("searchBuilder.logicOr",this.c.i18n.logicOr):this.s.dt.i18n("searchBuilder.logicAnd",this.c.i18n.logicAnd));for(var _i=0,_a=loadedDetails.criteria;_i<_a.length;_i++){var crit=_a[_i];if(crit.logic!==undefined){this._addPrevGroup(crit)}else if(crit.logic===undefined){this._addPrevCriteria(crit)}}for(var _b=0,_c=this.s.criteria;_b<_c.length;_b++){var crit=_c[_b];if(crit.criteria instanceof Criteria){crit.criteria.updateArrows(this.s.criteria.length>1,false);this._setCriteriaListeners(crit.criteria)}}};Group.prototype.redrawContents=function(){$$1(this.dom.container).empty().append(this.dom.logicContainer).append(this.dom.add);this.s.criteria.sort(function(a,b){if(a.criteria.s.index<b.criteria.s.index){return-1}else if(a.criteria.s.index>b.criteria.s.index){return 1}return 0});this.setListeners();for(var i=0;i<this.s.criteria.length;i++){var crit=this.s.criteria[i].criteria;if(crit instanceof Criteria){this.s.criteria[i].index=i;this.s.criteria[i].criteria.s.index=i;$$1(this.s.criteria[i].criteria.dom.container).insertBefore(this.dom.add);this._setCriteriaListeners(crit);this.s.criteria[i].criteria.rebuild(this.s.criteria[i].criteria.getDetails())}else if(crit instanceof Group&&crit.s.criteria.length>0){this.s.criteria[i].index=i;this.s.criteria[i].criteria.s.index=i;$$1(this.s.criteria[i].criteria.dom.container).insertBefore(this.dom.add);crit.redrawContents();this._setGroupListeners(crit)}else{this.s.criteria.splice(i,1);i--}}this.setupLogic()};Group.prototype.search=function(rowData,rowIdx){if(this.s.logic==="AND"){return this._andSearch(rowData,rowIdx)}else if(this.s.logic==="OR"){return this._orSearch(rowData,rowIdx)}return true};Group.prototype.setupLogic=function(){$$1(this.dom.logicContainer).remove();$$1(this.dom.clear).remove();if(this.s.criteria.length<1){if(!this.s.isChild){$$1(this.dom.container).trigger("dtsb-destroy");$$1(this.dom.container).css("margin-left",0)}return}var height=$$1(this.dom.container).height()-2;$$1(this.dom.clear).height("0px");$$1(this.dom.logicContainer).append(this.dom.clear).width(height);$$1(this.dom.container).prepend(this.dom.logicContainer);this._setLogicListener();$$1(this.dom.container).css("margin-left",$$1(this.dom.logicContainer).outerHeight(true));var logicOffset=$$1(this.dom.logicContainer).offset();var currentLeft=logicOffset.left;var groupLeft=$$1(this.dom.container).offset().left;var shuffleLeft=currentLeft-groupLeft;var newPos=currentLeft-shuffleLeft-$$1(this.dom.logicContainer).outerHeight(true);$$1(this.dom.logicContainer).offset({left:newPos});var firstCrit=$$1(this.dom.logicContainer).next();var currentTop=logicOffset.top;var firstTop=$$1(firstCrit).offset().top;var shuffleTop=currentTop-firstTop;var newTop=currentTop-shuffleTop;$$1(this.dom.logicContainer).offset({top:newTop});$$1(this.dom.clear).outerHeight($$1(this.dom.logicContainer).height());this._setClearListener()};Group.prototype.setListeners=function(){var _this=this;$$1(this.dom.add).unbind("click");$$1(this.dom.add).on("click",function(){if(!_this.s.isChild){$$1(_this.dom.container).prepend(_this.dom.logicContainer)}_this.addCriteria();$$1(_this.dom.container).trigger("dtsb-add");_this.s.dt.state.save();return false});for(var _i=0,_a=this.s.criteria;_i<_a.length;_i++){var crit=_a[_i];crit.criteria.setListeners()}this._setClearListener();this._setLogicListener()};Group.prototype.addCriteria=function(crit,redraw){if(crit===void 0){crit=null}if(redraw===void 0){redraw=true}var index=crit===null?this.s.criteria.length:crit.s.index;var criteria=new Criteria(this.s.dt,this.s.opts,this.s.topGroup,index,this.s.depth);if(crit!==null){criteria.c=crit.c;criteria.s=crit.s;criteria.s.depth=this.s.depth;criteria.classes=crit.classes}criteria.populate();var inserted=false;for(var i=0;i<this.s.criteria.length;i++){if(i===0&&this.s.criteria[i].criteria.s.index>criteria.s.index){$$1(criteria.getNode()).insertBefore(this.s.criteria[i].criteria.dom.container);inserted=true}else if(i<this.s.criteria.length-1&&this.s.criteria[i].criteria.s.index<criteria.s.index&&this.s.criteria[i+1].criteria.s.index>criteria.s.index){$$1(criteria.getNode()).insertAfter(this.s.criteria[i].criteria.dom.container);inserted=true}}if(!inserted){$$1(criteria.getNode()).insertBefore(this.dom.add)}this.s.criteria.push({criteria:criteria,index:index});this.s.criteria=this.s.criteria.sort(function(a,b){return a.criteria.s.index-b.criteria.s.index});for(var _i=0,_a=this.s.criteria;_i<_a.length;_i++){var opt=_a[_i];if(opt.criteria instanceof Criteria){opt.criteria.updateArrows(this.s.criteria.length>1,redraw)}}this._setCriteriaListeners(criteria);criteria.setListeners();this.setupLogic()};Group.prototype.checkFilled=function(){for(var _i=0,_a=this.s.criteria;_i<_a.length;_i++){var crit=_a[_i];if(crit.criteria instanceof Criteria&&crit.criteria.s.filled||crit.criteria instanceof Group&&crit.criteria.checkFilled()){return true}}return false};Group.prototype.count=function(){var count=0;for(var _i=0,_a=this.s.criteria;_i<_a.length;_i++){var crit=_a[_i];if(crit.criteria instanceof Group){count+=crit.criteria.count()}else{count++}}return count};Group.prototype._addPrevGroup=function(loadedGroup){var idx=this.s.criteria.length;var group=new Group(this.s.dt,this.c,this.s.topGroup,idx,true,this.s.depth+1);this.s.criteria.push({criteria:group,index:idx,logic:group.s.logic});group.rebuild(loadedGroup);this.s.criteria[idx].criteria=group;$$1(this.s.topGroup).trigger("dtsb-redrawContents");this._setGroupListeners(group)};Group.prototype._addPrevCriteria=function(loadedCriteria){var idx=this.s.criteria.length;var criteria=new Criteria(this.s.dt,this.s.opts,this.s.topGroup,idx,this.s.depth);criteria.populate();this.s.criteria.push({criteria:criteria,index:idx});criteria.rebuild(loadedCriteria);this.s.criteria[idx].criteria=criteria;$$1(this.s.topGroup).trigger("dtsb-redrawContents")};Group.prototype._andSearch=function(rowData,rowIdx){if(this.s.criteria.length===0){return true}for(var _i=0,_a=this.s.criteria;_i<_a.length;_i++){var crit=_a[_i];if(crit.criteria instanceof Criteria&&!crit.criteria.s.filled){continue}else if(!crit.criteria.search(rowData,rowIdx)){return false}}return true};Group.prototype._orSearch=function(rowData,rowIdx){if(this.s.criteria.length===0){return true}var filledfound=false;for(var _i=0,_a=this.s.criteria;_i<_a.length;_i++){var crit=_a[_i];if(crit.criteria instanceof Criteria&&crit.criteria.s.filled){filledfound=true;if(crit.criteria.search(rowData,rowIdx)){return true}}else if(crit.criteria instanceof Group&&crit.criteria.checkFilled()){filledfound=true;if(crit.criteria.search(rowData,rowIdx)){return true}}}return!filledfound};Group.prototype._removeCriteria=function(criteria,group){if(group===void 0){group=false}if(this.s.criteria.length<=1&&this.s.isChild){this.destroy()}else{var last=void 0;for(var i=0;i<this.s.criteria.length;i++){if(this.s.criteria[i].index===criteria.s.index&&(!group||this.s.criteria[i].criteria instanceof Group)){last=i}}if(last!==undefined){this.s.criteria.splice(last,1)}for(var i=0;i<this.s.criteria.length;i++){this.s.criteria[i].index=i;this.s.criteria[i].criteria.s.index=i}}};Group.prototype._setCriteriaListeners=function(criteria){var _this=this;$$1(criteria.dom["delete"]).unbind("click").on("click",function(){_this._removeCriteria(criteria);$$1(criteria.dom.container).remove();for(var _i=0,_a=_this.s.criteria;_i<_a.length;_i++){var crit=_a[_i];if(crit.criteria instanceof Criteria){crit.criteria.updateArrows(_this.s.criteria.length>1)}}criteria.destroy();_this.s.dt.draw();$$1(_this.s.topGroup).trigger("dtsb-redrawContents");$$1(_this.s.topGroup).trigger("dtsb-updateTitle");return false});$$1(criteria.dom.right).unbind("click").on("click",function(){var idx=criteria.s.index;var group=new Group(_this.s.dt,_this.s.opts,_this.s.topGroup,criteria.s.index,true,_this.s.depth+1);group.addCriteria(criteria);_this.s.criteria[idx].criteria=group;_this.s.criteria[idx].logic="AND";$$1(_this.s.topGroup).trigger("dtsb-redrawContents");_this._setGroupListeners(group);return false});$$1(criteria.dom.left).unbind("click").on("click",function(){_this.s.toDrop=new Criteria(_this.s.dt,_this.s.opts,_this.s.topGroup,criteria.s.index);_this.s.toDrop.s=criteria.s;_this.s.toDrop.c=criteria.c;_this.s.toDrop.classes=criteria.classes;_this.s.toDrop.populate();var index=_this.s.toDrop.s.index;$$1(_this.dom.container).trigger("dtsb-dropCriteria");criteria.s.index=index;_this._removeCriteria(criteria);$$1(_this.s.topGroup).trigger("dtsb-redrawContents");_this.s.dt.draw();return false})};Group.prototype._setClearListener=function(){var _this=this;$$1(this.dom.clear).unbind("click").on("click",function(){if(!_this.s.isChild){$$1(_this.dom.container).trigger("dtsb-clearContents");return false}_this.destroy();$$1(_this.s.topGroup).trigger("dtsb-updateTitle");$$1(_this.s.topGroup).trigger("dtsb-redrawContents");return false})};Group.prototype._setGroupListeners=function(group){var _this=this;$$1(group.dom.add).unbind("click").on("click",function(){_this.setupLogic();$$1(_this.dom.container).trigger("dtsb-add");return false});$$1(group.dom.container).unbind("dtsb-add").on("dtsb-add",function(){_this.setupLogic();$$1(_this.dom.container).trigger("dtsb-add");return false});$$1(group.dom.container).unbind("dtsb-destroy").on("dtsb-destroy",function(){_this._removeCriteria(group,true);$$1(group.dom.container).remove();_this.setupLogic();return false});$$1(group.dom.container).unbind("dtsb-dropCriteria").on("dtsb-dropCriteria",function(){var toDrop=group.s.toDrop;toDrop.s.index=group.s.index;toDrop.updateArrows(_this.s.criteria.length>1,false);_this.addCriteria(toDrop,false);return false});group.setListeners()};Group.prototype._setup=function(){this.setListeners();$$1(this.dom.add).text(this.s.dt.i18n("searchBuilder.add",this.c.i18n.add));$$1(this.dom.logic).text(this.c.logic==="OR"?this.s.dt.i18n("searchBuilder.logicOr",this.c.i18n.logicOr):this.s.dt.i18n("searchBuilder.logicAnd",this.c.i18n.logicAnd));this.s.logic=this.c.logic==="OR"?"OR":"AND";if(this.c.greyscale){$$1(this.dom.logic).addClass(this.classes.greyscale)}$$1(this.dom.logicContainer).append(this.dom.logic).append(this.dom.clear);if(this.s.isChild){$$1(this.dom.container).append(this.dom.logicContainer)}$$1(this.dom.container).append(this.dom.add)};Group.prototype._setLogicListener=function(){var _this=this;$$1(this.dom.logic).unbind("click").on("click",function(){_this._toggleLogic();_this.s.dt.draw();for(var _i=0,_a=_this.s.criteria;_i<_a.length;_i++){var crit=_a[_i];crit.criteria.setListeners()}})};Group.prototype._toggleLogic=function(){if(this.s.logic==="OR"){this.s.logic="AND";$$1(this.dom.logic).text(this.s.dt.i18n("searchBuilder.logicAnd",this.c.i18n.logicAnd))}else if(this.s.logic==="AND"){this.s.logic="OR";$$1(this.dom.logic).text(this.s.dt.i18n("searchBuilder.logicOr",this.c.i18n.logicOr))}};Group.version="1.0.0";Group.classes={add:"dtsb-add",button:"dtsb-button",clearGroup:"dtsb-clearGroup",greyscale:"dtsb-greyscale",group:"dtsb-group",inputButton:"dtsb-iptbtn",logic:"dtsb-logic",logicContainer:"dtsb-logicContainer"};Group.defaults={columns:true,conditions:{date:Criteria.dateConditions,html:Criteria.stringConditions,"html-num":Criteria.numConditions,"html-num-fmt":Criteria.numFmtConditions,moment:Criteria.momentDateConditions,num:Criteria.numConditions,"num-fmt":Criteria.numFmtConditions,string:Criteria.stringConditions},depthLimit:false,filterChanged:undefined,greyscale:false,i18n:{add:"Add Condition",button:{0:"Search Builder",_:"Search Builder (%d)"},clearAll:"Clear All",condition:"Condition",data:"Data",deleteTitle:"Delete filtering rule",leftTitle:"Outdent criteria",logicAnd:"And",logicOr:"Or",rightTitle:"Indent criteria",title:{0:"Custom Search Builder",_:"Custom Search Builder (%d)"},value:"Value",valueJoiner:"and"},logic:"AND",orthogonal:{display:"display",search:"filter"},preDefined:false};return Group}();var $$2;var DataTable$2;function setJQuery$2(jq){$$2=jq;DataTable$2=jq.fn.DataTable}var SearchBuilder=function(){function SearchBuilder(builderSettings,opts){var _this=this;if(!DataTable$2||!DataTable$2.versionCheck||!DataTable$2.versionCheck("1.10.0")){throw new Error("SearchBuilder requires DataTables 1.10 or newer")}var table=new DataTable$2.Api(builderSettings);this.classes=$$2.extend(true,{},SearchBuilder.classes);this.c=$$2.extend(true,{},SearchBuilder.defaults,opts);this.dom={clearAll:$$2('<button type="button">'+table.i18n("searchBuilder.clearAll",this.c.i18n.clearAll)+"</button>").addClass(this.classes.clearAll).addClass(this.classes.button).attr("type","button"),container:$$2("<div/>").addClass(this.classes.container),title:$$2("<div/>").addClass(this.classes.title),titleRow:$$2("<div/>").addClass(this.classes.titleRow),topGroup:undefined};this.s={dt:table,opts:opts,search:undefined,topGroup:undefined};if(table.settings()[0]._searchBuilder!==undefined){return}table.settings()[0]._searchBuilder=this;if(this.s.dt.settings()[0]._bInitComplete){this._setUp()}else{table.one("init.dt",function(){_this._setUp()})}return this}SearchBuilder.prototype.getDetails=function(){return this.s.topGroup.getDetails()};SearchBuilder.prototype.getNode=function(){return this.dom.container};SearchBuilder.prototype.rebuild=function(details){$$2(this.dom.clearAll).click();if(details===undefined||details===null){return this}this.s.topGroup.rebuild(details);this.s.dt.draw();this.s.topGroup.setListeners();return this};SearchBuilder.prototype._applyPreDefDefaults=function(preDef){var _this=this;if(preDef.criteria!==undefined&&preDef.logic===undefined){preDef.logic="AND"}var _loop_1=function(crit){if(crit.criteria!==undefined){crit=this_1._applyPreDefDefaults(crit)}else{this_1.s.dt.columns().every(function(index){if(_this.s.dt.settings()[0].aoColumns[index].sTitle===crit.data){crit.dataIdx=index}})}};var this_1=this;for(var _i=0,_a=preDef.criteria;_i<_a.length;_i++){var crit=_a[_i];_loop_1(crit)}return preDef};SearchBuilder.prototype._setUp=function(loadState){var _this=this;if(loadState===void 0){loadState=true}this.s.topGroup=new Group(this.s.dt,this.c,undefined);this._setClearListener();this.s.dt.on("stateSaveParams",function(e,settings,data){data.searchBuilder=_this.getDetails();data.page=_this.s.dt.page()});this._build();if(loadState){var loadedState=this.s.dt.state.loaded();if(loadedState!==null&&loadedState.searchBuilder!==undefined){this.s.topGroup.rebuild(loadedState.searchBuilder);$$2(this.s.topGroup.dom.container).trigger("dtsb-redrawContents");this.s.dt.page(loadedState.page).draw("page");this.s.topGroup.setListeners()}else if(this.c.preDefined!==false){this.c.preDefined=this._applyPreDefDefaults(this.c.preDefined);this.rebuild(this.c.preDefined)}}this._setEmptyListener();this.s.dt.state.save()};SearchBuilder.prototype._updateTitle=function(count){$$2(this.dom.title).text(this.s.dt.i18n("searchBuilder.title",this.c.i18n.title,count))};SearchBuilder.prototype._build=function(){var _this=this;$$2(this.dom.clearAll).remove();$$2(this.dom.container).empty();var count=this.s.topGroup.count();this._updateTitle(count);$$2(this.dom.titleRow).append(this.dom.title);$$2(this.dom.container).append(this.dom.titleRow);this.dom.topGroup=this.s.topGroup.getNode();$$2(this.dom.container).append(this.dom.topGroup);this._setRedrawListener();var tableNode=this.s.dt.table(0).node();if($$2.fn.dataTable.ext.search.indexOf(this.s.search)===-1){this.s.search=function(settings,searchData,dataIndex,origData){if(settings.nTable!==tableNode){return true}return _this.s.topGroup.search(searchData,dataIndex)};$$2.fn.dataTable.ext.search.push(this.s.search)}$$2.fn.DataTable.Api.registerPlural("columns().type()","column().type()",function(selector,opts){return this.iterator("column",function(settings,column){return settings.aoColumns[column].sType},1)});this.s.dt.on("destroy.dt",function(){$$2(_this.dom.container).remove();$$2(_this.dom.clearAll).remove();var searchIdx=$$2.fn.dataTable.ext.search.indexOf(_this.s.search);while(searchIdx!==-1){$$2.fn.dataTable.ext.search.splice(searchIdx,1);searchIdx=$$2.fn.dataTable.ext.search.indexOf(_this.s.search)}})};SearchBuilder.prototype._checkClear=function(){if(this.s.topGroup.s.criteria.length>0){$$2(this.dom.clearAll).insertAfter(this.dom.title);this._setClearListener()}else{$$2(this.dom.clearAll).remove()}};SearchBuilder.prototype._filterChanged=function(count){var fn=this.c.filterChanged;if(typeof fn==="function"){fn(count,this.s.dt.i18n("searchBuilder.button",this.c.i18n.button,count))}};SearchBuilder.prototype._setClearListener=function(){var _this=this;$$2(this.dom.clearAll).unbind("click");$$2(this.dom.clearAll).on("click",function(){_this.s.topGroup=new Group(_this.s.dt,_this.c,undefined);_this._build();_this.s.dt.draw();_this.s.topGroup.setListeners();$$2(_this.dom.clearAll).remove();_this._setEmptyListener();_this._filterChanged(0);return false})};SearchBuilder.prototype._setRedrawListener=function(){var _this=this;$$2(this.s.topGroup.dom.container).unbind("dtsb-redrawContents");$$2(this.s.topGroup.dom.container).on("dtsb-redrawContents",function(){_this._checkClear();_this.s.topGroup.redrawContents();_this.s.topGroup.setupLogic();_this._setEmptyListener();var count=_this.s.topGroup.count();_this._updateTitle(count);_this._filterChanged(count);_this.s.dt.state.save()});$$2(this.s.topGroup.dom.container).unbind("dtsb-clearContents");$$2(this.s.topGroup.dom.container).on("dtsb-clearContents",function(){_this._setUp(false);_this._filterChanged(0);_this.s.dt.draw()});$$2(this.s.topGroup.dom.container).on("dtsb-updateTitle",function(){var count=_this.s.topGroup.count();_this._updateTitle(count);_this._filterChanged(count)})};SearchBuilder.prototype._setEmptyListener=function(){var _this=this;$$2(this.s.topGroup.dom.add).on("click",function(){_this._checkClear()});$$2(this.s.topGroup.dom.container).on("dtsb-destroy",function(){$$2(_this.dom.clearAll).remove()})};SearchBuilder.version="1.0.1";SearchBuilder.classes={button:"dtsb-button",clearAll:"dtsb-clearAll",container:"dtsb-searchBuilder",inputButton:"dtsb-iptbtn",title:"dtsb-title",titleRow:"dtsb-titleRow"};SearchBuilder.defaults={columns:true,conditions:{date:Criteria.dateConditions,html:Criteria.stringConditions,"html-num":Criteria.numConditions,"html-num-fmt":Criteria.numFmtConditions,moment:Criteria.momentDateConditions,num:Criteria.numConditions,"num-fmt":Criteria.numFmtConditions,string:Criteria.stringConditions},depthLimit:false,filterChanged:undefined,greyscale:false,i18n:{add:"Add Condition",button:{0:"Search Builder",_:"Search Builder (%d)"},clearAll:"Clear All",condition:"Condition",conditions:{array:{contains:"Contains",empty:"Empty",equals:"Equals",not:"Not",notEmpty:"Not Empty",without:"Without"},date:{after:"After",before:"Before",between:"Between",empty:"Empty",equals:"Equals",not:"Not",notBetween:"Not Between",notEmpty:"Not Empty"},moment:{after:"After",before:"Before",between:"Between",empty:"Empty",equals:"Equals",not:"Not",notBetween:"Not Between",notEmpty:"Not Empty"},number:{between:"Between",empty:"Empty",equals:"Equals",gt:"Greater Than",gte:"Greater Than Equal To",lt:"Less Than",lte:"Less Than Equal To",not:"Not",notBetween:"Not Between",notEmpty:"Not Empty"},string:{contains:"Contains",empty:"Empty",endsWith:"Ends With",equals:"Equals",not:"Not",notEmpty:"Not Empty",startsWith:"Starts With"}},data:"Data",deleteTitle:"Delete filtering rule",leftTitle:"Outdent criteria",logicAnd:"And",logicOr:"Or",rightTitle:"Indent criteria",title:{0:"Custom Search Builder",_:"Custom Search Builder (%d)"},value:"Value",valueJoiner:"and"},logic:"AND",orthogonal:{display:"display",search:"filter"},preDefined:false};return SearchBuilder}();(function(factory){if(typeof define==="function"&&define.amd){define(["jquery","datatables.net"],function($){return factory($,window,document)})}else if(typeof exports==="object"){module.exports=function(root,$){if(!root){root=window}if(!$||!$.fn.dataTable){$=require("datatables.net")(root,$).$}return factory($,root,root.document)}}else{factory(window.jQuery,window,document)}})(function($,window,document){setJQuery$2($);setJQuery$1($);setJQuery($);var DataTable=$.fn.dataTable;$.fn.dataTable.SearchBuilder=SearchBuilder;$.fn.DataTable.SearchBuilder=SearchBuilder;$.fn.dataTable.Group=Group;$.fn.DataTable.Group=Group;$.fn.dataTable.Criteria=Criteria;$.fn.DataTable.Criteria=Criteria;var apiRegister=$.fn.dataTable.Api.register;$.fn.dataTable.ext.searchBuilder={conditions:{}};$.fn.dataTable.ext.buttons.searchBuilder={action:function(e,dt,node,config){e.stopPropagation();this.popover(config._searchBuilder.getNode(),{align:"dt-container"})},config:{},init:function(dt,node,config){var sb=new $.fn.dataTable.SearchBuilder(dt,$.extend({filterChanged:function(count,text){dt.button(node).text(text)}},config.config));dt.button(node).text(config.text||dt.i18n("searchBuilder.button",sb.c.i18n.button,0));config._searchBuilder=sb},text:null};apiRegister("searchBuilder.getDetails()",function(){var ctx=this.context[0];return ctx._searchBuilder.getDetails()});apiRegister("searchBuilder.rebuild()",function(details){var ctx=this.context[0];ctx._searchBuilder.rebuild(details);return this});apiRegister("searchBuilder.container()",function(){var ctx=this.context[0];return ctx._searchBuilder.getNode()});function _init(settings,options){var api=new DataTable.Api(settings);var opts=options?options:api.init().searchBuilder||DataTable.defaults.searchBuilder;var searchBuilder=new SearchBuilder(api,opts);var node=searchBuilder.getNode();return node}$(document).on("preInit.dt.dtsp",function(e,settings,json){if(e.namespace!=="dt"){return}if(settings.oInit.searchBuilder||DataTable.defaults.searchBuilder){if(!settings._searchBuilder){_init(settings)}}});DataTable.ext.feature.push({cFeature:"Q",fnInit:_init});if(DataTable.ext.features){DataTable.ext.features.register("searchBuilder",_init)}})})();